---
title: "Seurat_TD"
author: Sida Chen
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(Seurat)
library(patchwork)
```

# IFE001
```{r}
# Load datasets
IFE001.data <- Read10X(data_dir <- '~/Documents/cellranger/IFE001/outs/filtered_feature_bc_matrix')
# Initialize Seurat Object
IFE001 <- CreateSeuratObject(counts = IFE001.data, project = 'IFE', min.cells = 3, min.features = 200)
```

## Normalizing data --- Log normalization, scale = 10000
```{r}
IFE001 <- NormalizeData(IFE001)
```

## Scaling the data
```{r}
all.genes_IFE001 <- rownames(IFE001)
IFE001 <- ScaleData(IFE001, features = all.genes_IFE001)
```

## Linear Dimentional Reduction
```{r}
IFE001 <- FindVariableFeatures(IFE001, selection.method = "vst", nfeatures = 2000)

IFE001 <- RunPCA(IFE001, features = VariableFeatures(object = IFE001))
print(IFE001[["pca"]], dims = 1:5, nfeature = 5)
VizDimLoadings(IFE001, dims = 1:2, reduction = "pca")
DimPlot(IFE001, reduction = "pca") + NoLegend()
```

## Cluster
```{r}
IFE001 <- FindNeighbors(IFE001, dims = 1:10)
IFE001 <- FindClusters(IFE001, resolution = 0.5)
head(Idents(IFE001), 5)
```

## Non-linear dimensional reduction (UMAP/tSNE)
```{r}
IFE001 <- RunUMAP(IFE001, dims = 1:10)
DimPlot(IFE001, reduction = "umap")
saveRDS(IFE001, file = "./IFE001_umap.rds")
```

## Cluster biomarkers & DEGs




# IFE002
```{r}
# Load datasets
IFE002.data <- Read10X(data_dir <- '~/Documents/cellranger/IFE002/outs/filtered_feature_bc_matrix')
# Initialize Seurat Object
IFE002 <- CreateSeuratObject(counts = IFE002.data, project = 'IFE', min.cells = 3, min.features = 200)
```

## Normalizing data --- Log normalization, scale = 10000
```{r}
IFE002 <- NormalizeData(IFE002)
```

## Scaling the data
```{r}
all.genes_IFE002 <- rownames(IFE002)
IFE002 <- ScaleData(IFE002, features = all.genes_IFE002)
```

## Linear Dimentional Reduction
```{r}
IFE002 <- FindVariableFeatures(IFE002, selection.method = "vst", nfeatures = 2000)

IFE002 <- RunPCA(IFE002, features = VariableFeatures(object = IFE002))
print(IFE002[["pca"]], dims = 1:5, nfeature = 5)
VizDimLoadings(IFE002, dims = 1:2, reduction = "pca")
DimPlot(IFE002, reduction = "pca") + NoLegend()
```

## Cluster
```{r}
IFE002 <- FindNeighbors(IFE002, dims = 1:10)
IFE002 <- FindClusters(IFE002, resolution = 0.5)
head(Idents(IFE002), 5)
```

## Non-linear dimensional reduction (UMAP/tSNE)
```{r}
IFE002 <- RunUMAP(IFE002, dims = 1:10)
DimPlot(IFE002, reduction = "umap")
saveRDS(IFE002, file = "./IFE002_umap.rds")
```


# IFE003
```{r}
# Load datasets
IFE003.data <- Read10X(data_dir <- '~/Documents/cellranger/IFE003/outs/filtered_feature_bc_matrix')
# Initialize Seurat Object
IFE003 <- CreateSeuratObject(counts = IFE003.data, project = 'IFE', min.cells = 3, min.features = 200)
```

## Normalizing data --- Log normalization, scale = 10000
```{r}
IFE003 <- NormalizeData(IFE003)
```

## Scaling the data
```{r}
all.genes_IFE003 <- rownames(IFE003)
IFE003 <- ScaleData(IFE003, features = all.genes_IFE003)
```

## Linear Dimentional Reduction
```{r}
IFE003 <- FindVariableFeatures(IFE003, selection.method = "vst", nfeatures = 2000)

IFE003 <- RunPCA(IFE003, features = VariableFeatures(object = IFE003))
print(IFE003[["pca"]], dims = 1:5, nfeature = 5)
VizDimLoadings(IFE003, dims = 1:2, reduction = "pca")
DimPlot(IFE003, reduction = "pca") + NoLegend()
```

## Cluster
```{r}
IFE003 <- FindNeighbors(IFE003, dims = 1:10)
IFE003 <- FindClusters(IFE003, resolution = 0.5)
head(Idents(IFE003), 5)
```

## Non-linear dimensional reduction (UMAP/tSNE)
```{r}
IFE003 <- RunUMAP(IFE003, dims = 1:10)
DimPlot(IFE003, reduction = "umap")
saveRDS(IFE003, file = "./IFE003_umap.rds")
```








